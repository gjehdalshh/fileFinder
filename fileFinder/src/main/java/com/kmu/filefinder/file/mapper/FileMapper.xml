<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kmu.filefinder.file.mapper.FileMapper">
	<!-- read -->
	<select id="getCategoryPathByIcategory" resultType="string">
		SELECT
		category_path FROM category WHERE i_category = #{i_category};
	</select>
	<select id="getFileNameList" resultType="string">
		SELECT file_nm FROM
		file;
	</select>

	<!-- 전체 보기 -->
	<select id="getFileCategoryInfoList"
		resultType="FileCategoryDTO">
		SELECT a.i_file, a.file_nm, a.file_extension, a.r_dt,
		a.i_category, a.file_path, b.category_nm FROM file as a LEFT JOIN
		category as b ON a.i_category = b.i_category;
	</select>

	<!-- 대분류 클릭 시 세부 소분류 전체 보기 -->
	<select id="getIcategoryByCategoryNm" resultType="int">
		SELECT
		i_category FROM category WHERE category_nm = #{category_nm};
	</select>
	<select id="getIcategoryByCategoryTop" resultType="int">
		SELECT
		i_category FROM category where category_top = #{category_top};
	</select>
	<select id="getFileInfoList" resultType="FileCategoryDTO">
		SELECT a.i_file,
		a.file_nm, a.file_extension, a.r_dt,
		a.i_category, a.file_path,
		b.category_nm FROM file as a LEFT JOIN
		category as b ON a.i_category =
		b.i_category WHERE a.i_category = #{i_category};
	</select>
	<select id="getFileSearchInfoList" resultType="FileCategoryDTO">
		SELECT a.i_file,
		a.file_nm, a.file_extension, a.r_dt,
		a.i_category, a.file_path,
		b.category_nm FROM file as a LEFT JOIN
		category as b ON a.i_category =
		b.i_category WHERE a.file_nm = #{file_nm};
	</select>

	<!-- create -->
	<insert id="createFile">
		INSERT INTO file (file_nm, file_extension,
		i_category, file_path)
		VALUES (#{file_nm}, #{file_extension},
		#{i_category}, #{file_path})
	</insert>

	<!-- update -->

	<!-- delete -->
</mapper>
